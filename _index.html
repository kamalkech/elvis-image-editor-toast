<html>
<head>
<script language="JavaScript" src="${pluginsBaseRootUrl}/web.shared/jquery.min.js"></script>
<script src="${pluginsBaseRootUrl}/web.shared/jquery.class.js" type="text/javascript"></script>
<script src="${pluginsBaseRootUrl}/web.shared/elvis_api/js/jquery.elvis.js" type="text/javascript"></script>

<!-- UI toast -->
<link
	type="text/css"
	href="https://uicdn.toast.com/tui-color-picker/v2.2.3/tui-color-picker.css"
	rel="stylesheet">
<link
	type="text/css"
	href="./tui.image-editor/dist/tui-image-editor.css"
	rel="stylesheet">
<style>
  @import url(http://fonts.googleapis.com/css?family=Noto+Sans);
  html, body {
    height: 100%;
    margin: 0;
  }
  .tui-image-editor-container {
  	height: 600px !important;
  }
</style>

<!--  -->
<script language="JavaScript" src="json/json2.patched-for-air.js"></script>
<script language="JavaScript">
	var elvisContext = ElvisPlugin.resolveElvisContext();

	$(document).ready(function() {
		// Get asset data
		var urlAssetSelect = elvisContext.activeTab.assetSelection[0].originalUrl;
		console.log('elvisContext', elvisContext)
		var imgUrl = elvisContext.activeTab.assetSelection[0].assetPath;

		// Image editor
		var nameFile = 'SampleImage';

    var imageEditor = new tui.ImageEditor('#tui-image-editor-container', {
      includeUI: {
        loadImage: {
          path: urlAssetSelect,
          name: nameFile
        },
        theme: blackTheme, // or whiteTheme
        initMenu: 'filter',
        menuBarPosition: 'bottom'
      },
      cssMaxWidth: 700,
      cssMaxHeight: 200,
      usageStatistics: false
    });

    window.onresize = function() {
      imageEditor.ui.resizeEditor();
    }

    $('.download-asset').click( function() {
    	// imageEditor.getActions().main.load(urlAssetSelect);
    	// imageEditor.getActions().main.download();
    })
	});
</script>
</head>
<body>

	<button class="download-asset">Download</button>
	<hr>

	<div id="tui-image-editor-container"></div>

  <script
    type="text/javascript"
    src="https://cdnjs.cloudflare.com/ajax/libs/fabric.js/3.3.2/fabric.js"></script>
  <script
    type="text/javascript"
    src="https://uicdn.toast.com/tui.code-snippet/v1.5.0/tui-code-snippet.min.js"></script>
  <script
    type="text/javascript"
    src="https://uicdn.toast.com/tui-color-picker/v2.2.3/tui-color-picker.js"></script>
  <script
    type="text/javascript"
    src="https://cdnjs.cloudflare.com/ajax/libs/FileSaver.js/1.3.3/FileSaver.min.js"></script>
  <script
    type="text/javascript"
    src="./tui.image-editor/dist/tui-image-editor.js"></script>
  <script
    type="text/javascript"
    src="./tui.image-editor/examples/js/theme/white-theme.js"></script>
  <script
    type="text/javascript"
    src="./tui.image-editor/examples/js/theme/black-theme.js"></script>
</body>
</html>